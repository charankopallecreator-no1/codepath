<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin Dashboard - Monitor students and conduct tests">
    <meta name="theme-color" content="#FF6B35">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CodePath Admin">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    
    <title>Admin Dashboard - CodePath</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="admin-page">
    <!-- Offline Indicator -->
    <div id="offlineIndicator" class="offline-indicator" style="display: none;">
        <span>ğŸ“¡ You're offline - Data saved locally</span>
    </div>

    <!-- Update Banner -->
    <div id="updateBanner" class="update-banner" style="display: none;">
        <div class="update-banner-content">
            <span>ğŸ‰ New version available!</span>
            <button class="btn btn-primary btn-small" id="updateButton">Update Now</button>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <svg width="35" height="35" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M25 5L45 15V35L25 45L5 35V15L25 5Z" stroke="currentColor" stroke-width="3" stroke-linejoin="round"/>
                    <path d="M25 15L35 20V30L25 35L15 30V20L25 15Z" fill="currentColor"/>
                </svg>
                <span>CodePath Admin</span>
            </div>
            
            <div class="nav-user">
                <!-- Network Status -->
                <div id="networkStatus" class="network-status online">
                    <span class="network-status-dot"></span>
                    <span id="networkStatusText">Online</span>
                </div>
                <a href="dashboard.html" class="btn btn-secondary">â† Back to Dashboard</a>
            </div>
        </div>
    </nav>

    <!-- Admin Content -->
    <div class="admin-container">
        <!-- Admin Tabs -->
        <div class="admin-tabs">
            <button class="admin-tab active" data-tab="overview" onclick="switchTab('overview')">
                ğŸ“Š Overview
            </button>
            <button class="admin-tab" data-tab="students" onclick="switchTab('students')">
                ğŸ‘¥ Students
            </button>
            <button class="admin-tab" data-tab="analytics" onclick="switchTab('analytics')">
                ğŸ“ˆ Analytics
            </button>
            <button class="admin-tab" data-tab="tests" onclick="switchTab('tests')">
                ğŸ“ Tests & Quizzes
            </button>
            <button class="admin-tab" data-tab="reports" onclick="switchTab('reports')">
                ğŸ“„ Reports
            </button>
        </div>

        <!-- Overview Tab -->
        <div id="overviewTab" class="tab-content active">
            <div class="admin-header">
                <h1>Admin Dashboard Overview</h1>
                <p>Monitor student progress and manage assessments</p>
            </div>

            <!-- Quick Stats -->
            <div class="admin-stats-grid">
                <div class="admin-stat-card">
                    <div class="stat-icon-large">ğŸ‘¥</div>
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">Total Students</div>
                    <div class="stat-change positive">+5 this week</div>
                </div>
                
                <div class="admin-stat-card">
                    <div class="stat-icon-large">ğŸ“Š</div>
                    <div class="stat-value" id="avgProgress">0%</div>
                    <div class="stat-label">Average Progress</div>
                    <div class="stat-change positive">+3% this month</div>
                </div>
                
                <div class="admin-stat-card">
                    <div class="stat-icon-large">âœ…</div>
                    <div class="stat-value" id="completedTests">0</div>
                    <div class="stat-label">Tests Completed</div>
                    <div class="stat-change neutral">12 pending</div>
                </div>
                
                <div class="admin-stat-card">
                    <div class="stat-icon-large">ğŸ¯</div>
                    <div class="stat-value" id="avgTestScore">0%</div>
                    <div class="stat-label">Average Test Score</div>
                    <div class="stat-change positive">+2% improvement</div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="admin-section">
                <h2>Recent Activity</h2>
                <div class="activity-feed" id="activityFeed">
                    <!-- Activity items will be generated here -->
                </div>
            </div>

            <!-- Top Performers -->
            <div class="admin-section">
                <h2>Top Performers This Month</h2>
                <div class="leaderboard">
                    <div class="leaderboard-item" id="topPerformers">
                        <!-- Top performers will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Students Tab -->
        <div id="studentsTab" class="tab-content">
            <div class="section-header">
                <h2>Student Management</h2>
                <div class="section-actions">
                    <input type="text" id="studentSearch" placeholder="Search students..." class="search-input">
                    <select id="filterYear" class="filter-select">
                        <option value="all">All Years</option>
                        <option value="1">Year 1</option>
                        <option value="2">Year 2</option>
                        <option value="3">Year 3</option>
                    </select>
                    <select id="filterProgress" class="filter-select">
                        <option value="all">All Progress</option>
                        <option value="high">75-100%</option>
                        <option value="medium">50-74%</option>
                        <option value="low">0-49%</option>
                    </select>
                </div>
            </div>

            <div class="table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Student</th>
                            <th>Email</th>
                            <th>Progress</th>
                            <th>Current Year</th>
                            <th>Modules</th>
                            <th>Tests</th>
                            <th>Last Active</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <!-- Students will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsTab" class="tab-content">
            <h2>Learning Analytics</h2>
            
            <!-- Progress Distribution -->
            <div class="analytics-section">
                <h3>Progress Distribution</h3>
                <div class="chart-container">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>

            <!-- Module Completion Rates -->
            <div class="analytics-section">
                <h3>Module Completion Rates</h3>
                <div class="module-completion-grid" id="moduleCompletionGrid">
                    <!-- Module completion bars will be generated here -->
                </div>
            </div>

            <!-- Time Analysis -->
            <div class="analytics-section">
                <h3>Learning Patterns</h3>
                <div class="stats-row">
                    <div class="mini-stat-card">
                        <div class="mini-stat-label">Average Study Time</div>
                        <div class="mini-stat-value">45 min/day</div>
                    </div>
                    <div class="mini-stat-card">
                        <div class="mini-stat-label">Most Active Day</div>
                        <div class="mini-stat-value">Wednesday</div>
                    </div>
                    <div class="mini-stat-card">
                        <div class="mini-stat-label">Peak Hours</div>
                        <div class="mini-stat-value">7-9 PM</div>
                    </div>
                    <div class="mini-stat-card">
                        <div class="mini-stat-label">Completion Rate</div>
                        <div class="mini-stat-value">78%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tests Tab -->
        <div id="testsTab" class="tab-content">
            <div class="section-header">
                <h2>Tests & Assessments</h2>
                <button class="btn btn-primary" onclick="showCreateTestModal()">
                    + Create New Test
                </button>
            </div>

            <!-- Test Library -->
            <div class="test-library" id="testLibrary">
                <!-- Test cards will be generated here -->
            </div>

            <!-- Test Results -->
            <div class="admin-section">
                <h3>Recent Test Results</h3>
                <div class="test-results-grid" id="testResultsGrid">
                    <!-- Test results will be populated here -->
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reportsTab" class="tab-content">
            <h2>Reports & Exports</h2>
            
            <div class="reports-grid">
                <div class="report-card">
                    <div class="report-icon">ğŸ“Š</div>
                    <h3>Progress Report</h3>
                    <p>Detailed student progress across all modules</p>
                    <button class="btn btn-primary" onclick="generateProgressReport()">Generate Report</button>
                </div>
                
                <div class="report-card">
                    <div class="report-icon">ğŸ“</div>
                    <h3>Test Results Summary</h3>
                    <p>Comprehensive test performance analysis</p>
                    <button class="btn btn-primary" onclick="generateTestReport()">Generate Report</button>
                </div>
                
                <div class="report-card">
                    <div class="report-icon">ğŸ‘¥</div>
                    <h3>Student Roster</h3>
                    <p>Complete list of enrolled students</p>
                    <button class="btn btn-primary" onclick="exportStudentRoster()">Export CSV</button>
                </div>
                
                <div class="report-card">
                    <div class="report-icon">ğŸ“ˆ</div>
                    <h3>Analytics Dashboard</h3>
                    <p>Visual analytics and insights</p>
                    <button class="btn btn-primary" onclick="generateAnalyticsReport()">View Analytics</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Detail Modal -->
    <div id="studentDetailModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-btn" onclick="closeStudentModal()">&times;</span>
            <div id="studentDetailContent">
                <!-- Student details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Create Test Modal -->
    <div id="createTestModal" class="modal">
        <div class="modal-content modal-large">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                <h2 style="margin: 0;">Create New Test</h2>
                <span class="close-btn" onclick="closeCreateTestModal()">&times;</span>
            </div>
            <button class="btn-back" onclick="closeCreateTestModal()">â† Back</button>
            
            <form id="createTestForm" onsubmit="handleCreateTest(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="testTitle">Test Title</label>
                        <input type="text" id="testTitle" required placeholder="e.g., C Programming Final">
                    </div>
                    
                    <div class="form-group">
                        <label for="testModule">Module</label>
                        <select id="testModule" required>
                            <option value="">Select Module</option>
                            <option value="c_programming">C Programming</option>
                            <option value="cpp_programming">C++ Programming</option>
                            <option value="python_basics">Python Programming</option>
                            <option value="javascript">JavaScript</option>
                            <option value="dsa">Data Structures & Algorithms</option>
                            <option value="react">React.js</option>
                            <option value="nodejs">Node.js</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="testDuration">Duration (minutes)</label>
                        <input type="number" id="testDuration" required min="5" max="180" value="60">
                    </div>
                    
                    <div class="form-group">
                        <label for="testDifficulty">Difficulty</label>
                        <select id="testDifficulty" required>
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="testDescription">Description</label>
                    <textarea id="testDescription" rows="3" placeholder="Brief description of the test..."></textarea>
                </div>

                <div class="questions-section">
                    <h3>Questions</h3>
                    <div id="questionsContainer">
                        <!-- Questions will be added here -->
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addQuestion()">+ Add Question</button>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCreateTestModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Test</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Assign Test Modal -->
    <div id="assignTestModal" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                <h2 style="margin: 0;">Assign Test to Students</h2>
                <span class="close-btn" onclick="closeAssignTestModal()">&times;</span>
            </div>
            <button class="btn-back" onclick="closeAssignTestModal()">â† Back</button>
            
            <div class="assign-test-content">
                <h3 id="assignTestTitle"></h3>
                
                <div class="form-group">
                    <label>Select Students:</label>
                    <div class="student-checkbox-list" id="studentCheckboxList">
                        <!-- Student checkboxes will be generated here -->
                    </div>
                </div>

                <div class="form-group">
                    <label for="testDeadline">Deadline</label>
                    <input type="datetime-local" id="testDeadline" class="form-control">
                </div>

                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="closeAssignTestModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="assignTestToStudents()">Assign Test</button>
                </div>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="application.js"></script>
    <script src="pwa.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializeAdminDashboard();
            setupNetworkStatus();
        });

        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to clicked button
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Load tab-specific data
            loadTabData(tabName);
        }

        function loadTabData(tabName) {
            switch(tabName) {
                case 'students':
                    loadStudentsTable();
                    break;
                case 'analytics':
                    loadAnalytics();
                    break;
                case 'tests':
                    loadTestLibrary();
                    break;
                case 'reports':
                    // Reports are static
                    break;
            }
        }

        function setupNetworkStatus() {
            const statusElement = document.getElementById('networkStatus');
            const statusText = document.getElementById('networkStatusText');
            
            function updateNetworkStatus() {
                if (navigator.onLine) {
                    statusElement.className = 'network-status online';
                    statusText.textContent = 'Online';
                } else {
                    statusElement.className = 'network-status offline';
                    statusText.textContent = 'Offline';
                }
            }
            
            window.addEventListener('online', updateNetworkStatus);
            window.addEventListener('offline', updateNetworkStatus);
            
            updateNetworkStatus();
        }
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About CodePath</h3>
                    <p>Your complete programming learning roadmap from basics to full-stack mastery.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="pwa-admin.html">ğŸ”§ Admin</a></li>
                        <li><a href="pwa-dashboard.html">ğŸ“Š Dashboard</a></li>
                        <li><a href="#" onclick="handleLogout()">ğŸšª Logout</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#">ğŸ“š Documentation</a></li>
                        <li><a href="#">ğŸ“ Tutorials</a></li>
                        <li><a href="#">â“ FAQ</a></li>
                        <li><a href="#">ğŸ’¬ Support</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Follow Us</h3>
                    <div class="social-links">
                        <a href="https://youtube.com" class="social-icon" title="YouTube" target="_blank">ğŸ“º</a>
                        <a href="https://instagram.com" class="social-icon" title="Instagram" target="_blank">ğŸ“·</a>
                        <a href="https://facebook.com" class="social-icon" title="Facebook" target="_blank">ğŸ‘¥</a>
                        <a href="https://twitter.com" class="social-icon" title="Twitter" target="_blank">ğ•</a>
                        <a href="https://github.com" class="social-icon" title="GitHub" target="_blank">ğŸ™</a>
                        <a href="https://discord.com" class="social-icon" title="Discord" target="_blank">ğŸ’¬</a>
                    </div>
                </div>
            </div>
            <div class="footer-divider"></div>
            <div class="footer-bottom">
                <div class="footer-copyright">&copy; 2026 CodePath. All rights reserved.</div>
                <div class="footer-credit">Made with ğŸ’– by <a href="https://github.com/charankkopalle" target="_blank">Charan K Kopalle</a></div>
            </div>
        </div>
    </footer>
</body>
</html>
